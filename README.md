# ShutBuddy -关机小卫士

## 功能说明
ShutBuddy 是一款基于磁盘活动监测的智能关机工具，通过实时分析磁盘I/O使用率，在系统完全空闲时安全触发关机，确保不会中断任何正在进行的工作。主要功能包括：

- 监测磁盘活动状态
- 检测未保存的文档
- 用户确认关机
- 详细的日志记录
- 测试模式支持

## 使用说明

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
# 正常模式(会实际关机)
python shutdownDown.py 

#双击运行Releases中的exe文件也可完成关机
shutdownDown.exe

# 测试模式(不会真正关机)
python shutdownDown.py --test
```

### 参数说明
- `--test`: 测试模式，仅检查条件不会真正关机

## 工作原理
1. 持续监测磁盘活动(每10秒检查一次)
2. 当连续10次磁盘利用率低于3%时(具体阈值可在代码中调整):
   - 检查是否有未保存的文档
   - 显示系统状态(磁盘、内存、CPU使用率)供用户参考（可在shutdown_log.txt文件中查看）
   - 弹出置顶确认对话框(3分钟内无操作将自动确认)
3. 最终关机依据:
   - 磁盘活动低于3%阈值(连续10次检测)
   - 没有未保存的文档
   - 用户确认关机或3分钟无任何操作
4. 用户确认（或者3分钟无任何操作）后30秒执行关机


## 安全特性
- 三重保护机制:
  1. 磁盘活动检测(连续10次低于3%利用率)
  2. 未保存文档检测
  3. 用户手动确认
- 所有对话框强制置顶显示
- 30秒关机缓冲时间
- 详细的日志记录(shutdown_log.txt)
- 完善的异常处理
- 阈值可配置(修改代码中的disk_usage_threshold变量)

## 日志文件
程序运行日志保存在`shutdown_log.txt`中，包含:
- 系统状态信息
- 关机操作记录
- 错误信息

## 注意事项
- 需要管理员权限才能执行关机操作
- 测试模式建议先使用`--test`参数验证
- 日志文件会不断增长，请定期清理
